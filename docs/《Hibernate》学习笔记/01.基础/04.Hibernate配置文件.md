---
title: Hibernate配置文件
date: 2021-09-30 21:22:29
permalink: /pages/109a89/
categories:
  - 《Hibernate》学习笔记
  - 基础
tags:
  - Hibernate
---

## hibernate.cfg.xml

### 1. 在hibernate中配置c3p0数据源

1.  导入jar包

   ```xml
       <!--c3p0数据源-->
       <dependency>
         <groupId>org.hibernate</groupId><!--包-->
         <artifactId>hibernate-c3p0</artifactId><!--项目名-->
         <version>5.5.7.Final</version><!--版本号-->
       </dependency>
   ```

   

2.  加入配置

   ```xml
   	<property name="connection.provider_class"><!--连接连接池的驱动-->
           org.hibernate.c3p0.internal.C3P0ConnectionProvider
       </property>
       <property name="c3p0.min_size"><!--连接池数量初始值-->
           5
       </property>
       <property name="c3p0.max_size"><!--连接池数量最大值-->
           10
       </property>
       <property name="c3p0.max_statements"><!--最多对数据库的操作数，最大执行的命令的个数-->
           30
       </property>
       <property name="hibernate.c3p0.timeout"><!--最大空闲时间-->
           600
       </property>
       <property name="hibernate.c3p0.idle_test_period"><!--定时检测-->
           60
       </property>
       <property name="hibernate.c3p0.acquire_increment"><!--扩建的连接池的数量（连接不够用的时候， 每次增加的连接数）-->
           1
       </property>
   ```

   

### 2. 一些其他配置

1. `hibernate.jdbc.fetch_size`

   > 设定JDBC的Statement依次读取数据库中的记录条数
   >
   > > 值越大，访问数据库次数越少，速度越快，但是对WEB服务器消耗越大

2. `hibernate.jdbc.batch_size`

   > 设定对数据库进行批量删除、批量更新、批量插入时的批次大小

> 以上两个配置对mysql无效，对Oracle有效...



## *.hbm.xml

### `hiberna-mapping`节点

1. `package`

   > 配置当前配置文件的映射类所在包名
   >
   > `<hibernate-mapping package="包名"> ... `

   ![主要配置]()

   

### `class`节点

1. `name`、`table`

   > name -- 类名  | table -- 对应数据库中的表名

2. `dynamic-insert`、`dynamic-update`

   > 动态更新与动态插入，根据用户执行命令动态生成sql语句，比如只更新某一个字段则只生成更新这个字段的sql语句

### `id`节点

1. `name` 、`column`

   >  name -- 实体类属性名  |  column -- 表中对应列名

2. `unsaved-value`

   > 设置该属性后，Hibernate会根据OID值来区分该对象是否为临时对象

3. `generator`

   > 主键生成器
   >
   > 1. increment：由Hibernate以递增的方式为代理主键赋值，容易发生并发问题
   > 2. identity：由底层数据库来负责生成标识符，要求底层数据库将逐渐定义为`Auto increment`
   > 3. sequence: 利用底层数据库提供的序列来生成标识符
   > 4. hilo：由hibernate按照一种high/low算法*生成标识符
   > 5. **native**：根据底层数据库对自动生成标识符的支持能力，来自动选择生成标识符的方式 

### `Property`

1. `name`、`column`

   > 实体类属性名以及表中列名

2. `type`

   > 指定Hibernate映射类型，即Java类型与SQL类型的桥梁，如果没有显示指定，则Hibernate通过反射机制自动获取，不过建议显示指定

3. `unique` 、 `update` 、 `index` 、 `length`

   > 唯一约束，是否可修改、索引、长度限制

4. `formula`

   > 派生属性：设置一个SQL表达式，Hibernate将根据它来计算派生属性的值
   >
   > > 乱入🤷‍♀️~~感觉和vue计算属性差不多
   > >
   > > > 语法： formula="(sql)"，注意要加"()"
   > > >
   > > > Sql表达式中的列名和表名都应该和数据库对应，而不是和持久化对象的属性对应

5. `scale`

   > 查询float或者double类型时，这个属性用来配置小数位数

[其他配置参考博客]([Hibernate映射文件*.hbm.xml的元素及属性详解 (biancheng.net)](http://c.biancheng.net/view/4177.html))



## 映射Java的事件、日期类型

### 基础知识

1. 在Java中，代表时间和日期的类型包括：`java.util.Date`和`java.util.Calendar`。此外在`JDBC API`中还提供了3个扩展了`java.util.Date`类的子类：`java.sql.Date`，`java.sql.Time`和`java.sql.Timestamp`，这三个类分别和标准`SQL`类型中的` DATE`，`TIME`和`TIMESTAMP`类型对应。
2. 在标准`SQL`中，`DATE`类型表示日期，`TIME `类型表示时间，`TIMESTAMP `类型表示时间戳，同时包含日期和时间信息。

### 如何进行映射？

1. 由于`java.util.date`是`JDBC API`的三个类的父类，所以它可以与`SQL`类型的三个类型映射

2. 鉴于1，所以在设置持久化类时，设置为`java.util.date`

3. 如何把`java.util.date`映射为` DATE`，`TIME`和`TIMESTAMP`？

   > 可以通过property中的type属性进行映射，如type="date"、type=“time”等



## 映射大对象类型

> 由于开发中并不常用，这里只做简单了解即可

![映射表](https://img-blog.csdn.net/20140531165528375)

1. 在 Java 中, `java.lang.String` 可用于表示长字符串(长度超过 255), 字节数组 byte[] 可用于存放图片或文件的二进制数据. 此外, 在 `JDBC API `中还提供了 `java.sql.Clob` 和 `java.sql.Blob` 类型, 它们分别和标准 SQL 中的 `CLOB` 和` BLOB `类型对应.` CLOB `表示字符串大对象(`Character Large Object`), BLOB表示二进制对象(`Binary Large Object`)
2. `Mysql` 不支持标准 `SQL` 的 `CLOB` 类型, 在` Mysql `中, 用 `TEXT`, `MEDIUMTEXT `及 `LONGTEXT` 类型来表示长度操作 255 的长文本数据
3. 在持久化类中, 二进制大对象可以声明为 `byte[]` 或 `java.sql.Blob` 类型; 字符串可以声明为 `java.lang.String` 或 `java.sql.Clob`
4. 实际上在 Java 应用程序中处理长度超过 255 的字符串, 使用` java.lang.String `比 `java.sql.Clob` 更方便



## 映射组成关系

> 映射一个实体类中包含了另一个实体类的实体类，需要用到`component`属性，这个被包含的实体类在Hibernate中称为组件

### `component`

1. `class`：包含的实体类的类名

2.  `name` ： 包含的实体类的名称

### `property`

1. `name`、`column`

   > 指定组成关系的组件的属性


