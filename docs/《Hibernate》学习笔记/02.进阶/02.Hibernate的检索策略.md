---
title: Hibernate的检索策略
date: 2021-10-01 15:47:02
permalink: /pages/0f4ae6/
categories:
  - 《Hibernate》学习笔记
  - 进阶
tags:
  - Hibernate
---

## Hibernate检索策略

### 类级别检索策略

1. 立即检索

   > 立即加载检索方法指定的对象

2. 延迟检索

   > 延迟加载检索方法指定的对象。在使用时在加载...

3. 类级别的检索策略可以通过`<class>`元素的`lazy`属性进行设置

4. 无论`<class>`元素的`lazy`属性设置为`true or false`，Session的get()方法及Query的list()方法在类级别上总是使用立即检索策略

   > 仅对Session的load()方法有效

### 一对多和多对多检索策略

1. **set的lazy属性**

   + 1--n 或 n -- n的集合属性默认使用延迟加载策略

     > 可以通过设置set的lazy属性来修改默认的检索策略，默认为true，并不建议设置为false

   + lazy还可以设置为extra，增强的延迟检索

     > 该取值会尽可能的延迟集合初始化的实际

2. **set的batch-size**

   + 设定一次初始化set集合的数量，能减少select语句的数目，提高延迟检索或立即检索的运行性能

3. **set的fetch**

   > 确定初始化orders集合被初始化的时机

   + 默认为select，通过正常的方式来初始化set元素
   + 可以取值为subselect，通过子查询的方式来初始化所有的set集合，子查询作为where语句的in的条件，子查询查询所有1的一端的ID，此时lazy有效，但batch-size失效
   + 若取值为join
     + 在加载1的一端的对现象时，使用迫切左外连接(使用左外连接的方式进行查询，且把集合属性进行初始化)的检索n的一端的集合属性
     + 忽略lazy属性
     + HQL查询忽略fetch=join的取值

   

### 多对一和一对一关联的检索策略

1. lazy取值为proxy和false分别代表对应的属性采用延迟检索和立即检索

2. fetch 取值为join，标识使用迫切左外连接的方式初始化n关联的1的一端的属性

   > 会忽略lazy属性

3. batch-size，该属性需要设置在1那一端的class元素中

   > 作用：一次初始化1的这一端的代理对象的个数

