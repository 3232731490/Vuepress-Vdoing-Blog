---
title: ã€437ã€‘è·¯å¾„æ€»å’Œâ…¢
date: 2021-09-28 09:08:54
permalink: /pages/74d1f3/
categories:
  - LeetCodeåˆ·é¢˜æ—¥è®°
  - LeetCodeæ‰“è„¸æ—¥è®°
tags:
  - LeetCode
---

## é¢˜ç›®é“¾æ¥
[437:è·¯å¾„æ€»å’Œâ…¢ğŸ](https://leetcode-cn.com/problems/path-sum-iii/)

## é¢˜ç›®æè¿°
> ç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ rootÂ ï¼Œå’Œä¸€ä¸ªæ•´æ•° `targetSum` ï¼Œæ±‚è¯¥äºŒå‰æ ‘é‡ŒèŠ‚ç‚¹å€¼ä¹‹å’Œç­‰äº `targetSum` çš„ è·¯å¾„ çš„æ•°ç›®ã€‚
> **è·¯å¾„** ä¸éœ€è¦ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä¹Ÿä¸éœ€è¦åœ¨å¶å­èŠ‚ç‚¹ç»“æŸï¼Œä½†æ˜¯è·¯å¾„æ–¹å‘å¿…é¡»æ˜¯å‘ä¸‹çš„ï¼ˆåªèƒ½ä»çˆ¶èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹ï¼‰ã€‚
> 
> ç¤ºä¾‹ 1ï¼š
> ![ç¤ºä¾‹ä¸€](https://assets.leetcode.com/uploads/2021/04/09/pathsum3-1-tree.jpg)
> 
> è¾“å…¥ï¼šroot = [10,5,-3,3,2,null,11,3,-2,null,1], targetSum = 8
> è¾“å‡ºï¼š3
> è§£é‡Šï¼šå’Œç­‰äº 8 çš„è·¯å¾„æœ‰ 3 æ¡ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚
> ç¤ºä¾‹ 2ï¼š
> 
> è¾“å…¥ï¼šroot = [5,4,8,11,null,13,4,7,2,null,null,5,1], targetSum = 22
> è¾“å‡ºï¼š3
> Â 
> æç¤º:
> äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°çš„èŒƒå›´æ˜¯ [0,1000]
> -109Â <= Node.val <= 109Â 
> -1000Â <= targetSumÂ <= 1000Â 

## è§£æ³•ä¸€ åŒDFS
```c++
/**
 * Definition for a binary tree node.
 * struct TreeNode {
 *     int val;
 *     TreeNode *left;
 *     TreeNode *right;
 *     TreeNode() : val(0), left(nullptr), right(nullptr) {}
 *     TreeNode(int x) : val(x), left(nullptr), right(nullptr) {}
 *     TreeNode(int x, TreeNode *left, TreeNode *right) : val(x), left(left), right(right) {}
 * };
 */
class Solution {
public:
    using ll = long long;
    int pathSum(TreeNode* root, int targetSum) {  // é€’å½’ä»å½“å‰èŠ‚ç‚¹å‡ºå‘æœ‰å¤šå°‘æ¡ç¬¦åˆè¦æ±‚çš„è·¯å¾„
        int ans=0;
        int t=0;
        function<void(TreeNode*,ll)> dfs2 = [&](TreeNode* cur,ll temp){
            if(cur==nullptr)
                return;
            if(cur->val==temp)
                t++;
            dfs2(cur->left,temp-cur->val);
            dfs2(cur->right,temp-cur->val);
        };
        function<void(TreeNode*)> dfs1 = [&](TreeNode* cur){  // é€’å½’äºŒå‰æ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºèµ·å§‹èŠ‚ç‚¹
            if(cur==nullptr)
                return;
            dfs2(cur->left,targetSum-cur->val);
            dfs2(cur->right,targetSum-cur->val);
            if(cur->val==targetSum)
                t++;
            ans += t;
            t=0;
            dfs1(cur->left);
            dfs1(cur->right);
        };
        dfs1(root);
        return ans;
    }
};
```
> æ‰§è¡Œç”¨æ—¶ï¼š**84 ms**, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†`5.31%`çš„ç”¨æˆ·
> å†…å­˜æ¶ˆè€—ï¼š**15.5 MB**, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†`48.15%`çš„ç”¨æˆ·

[^å‘œå‘œï¼Œæ€è·¯æ˜¯åˆ«äººç»™çš„ï¼Œä»£ç è‡ªå·±å†™çš„ï¼Œæˆ‘å¥½èœğŸ¤¦â€â™‚ï¸...]

## è§£æ³•äºŒ å‰ç¼€å’Œ
```c++
class Solution {
public:
    using ll = long long;
    unordered_map<ll,int> hash;
    int pathSum(TreeNode* root, int targetSum) {
        int ans=0;
        hash[0]=1;  // å¼€å§‹ç©ºè·¯å¾„æ—¶çš„è·¯å¾„æ•°ä¸º1
        function<void(TreeNode*,int)> dfs = [&](TreeNode* cur,ll temp){
            if(cur==nullptr)
                return;
            ll curr = cur->val+temp;  // å°†å½“å‰èŠ‚ç‚¹çš„å€¼åŠ å…¥åˆ°å‰ç¼€å’Œä¸­
            if(hash.find(curr-targetSum)!=hash.end()){  // åˆ¤æ–­å‰æ–¹è·¯å¾„ä¸­æ˜¯å¦å­˜åœ¨å€¼ä¸ºcurr-targetSumçš„å­è·¯å¾„
                ans+=hash[curr-targetSum];  // å¦‚æœæœ‰åˆ™ç­”æ¡ˆåŠ ä¸Šå­è·¯å¾„çš„æ¡æ•°
            }
            hash[curr]++; // å°†å½“å‰èŠ‚ç‚¹åŠ å…¥åˆ°å‰ç¼€å’Œå¼€å§‹ä¸‹ä¸€æ¬¡é€’å½’
            dfs(cur->left,curr);
            dfs(cur->right,curr);
            hash[curr]--; // å°†å½“å‰èŠ‚ç‚¹é€€å›
        };
        dfs(root,0);
        return ans;
    }
};
```
> æ‰§è¡Œç”¨æ—¶ï¼š**12 ms**, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†`93.60%`çš„ç”¨æˆ·
> å†…å­˜æ¶ˆè€—ï¼š**18.8 MB**, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†`23.38%`çš„ç”¨æˆ·

[^å‘œå‘œï¼Œæ€è·¯æ˜¯åˆ«äººç»™çš„ï¼Œä»£ç è‡ªå·±å†™çš„ï¼Œæˆ‘å¥½èœğŸ¤¦â€â™‚ï¸...]

> æœ¬é¢˜ç‚¹è¯„ï¼Œæ„Ÿè§‰éš¾åº¦å¹¶ä¸å¤§ï¼Œä½†æ˜¯å°±æ˜¯å·®é‚£ä¹ˆä¸€ç‚¹æƒ³å‡ºæ¥
> ä¸çŸ¥é“æ˜¯ä¸æ˜¯æœ€è¿‘åˆ·é¢˜æ‡ˆæ€ çš„åŸå› ğŸ‘©â€ğŸ¦¼
> æ²¡å…³ç³»ï¼Œç»§ç»­åŠ æ²¹ï¼Œä»Šå¤©ä¹Ÿæ˜¯å…ƒæ°”æ»¡æ»¡çš„ä¸€å¤©ğŸ¤´ğŸ½ğŸš›