(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{458:function(s,t,a){"use strict";a.r(t);var n=a(9),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[a("img",{attrs:{src:"https://tse1-mm.cn.bing.net/th/id/R-C.732225a2887ed09f6c37da51e0c9690f?rik=QhxiK7PhpzU1QQ&riu=http%3a%2f%2fwww.desktx.com%2fd%2ffile%2fwallpaper%2fscenery%2f20170217%2f9c2ea4858023fe79162a7941ce75b323.jpg&ehk=4W4dljnr3tMF9rLy4s%2b%2fv3Ve%2fx5WbfQckzcOfHeY1mc%3d&risl=&pid=ImgRaw&r=0",alt:"画廊展示"}})]),s._v(" "),a("h1",{attrs:{id:"将博客部署到自己的服务器上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将博客部署到自己的服务器上"}},[s._v("#")]),s._v(" 将博客部署到自己的服务器上")]),s._v(" "),a("blockquote",[a("p",[s._v("部署到GitHub的访问速度太慢，甚至还频繁出现无法访问的情况，被逼无奈，只好麻烦一点将博客部署到自己的云服务器，方便访问")]),s._v(" "),a("blockquote",[a("p",[s._v("在部署过程中又遇到了一系列问题，于是写下这篇博客记录一下")])])]),s._v(" "),a("h2",{attrs:{id:"第一步-创建自己的git仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-创建自己的git仓库"}},[s._v("#")]),s._v(" 第一步：创建自己的git仓库")]),s._v(" "),a("blockquote",[a("p",[s._v("由于要部署到自己的服务器，所以在自己的服务器上创建一个Git仓库是很有必要的，本博客采用的是Gitea工具创建Git仓库")])]),s._v(" "),a("blockquote",[a("p",[s._v("由于需要使用"),a("code",[s._v("gitea")]),s._v("，为了避免一系列繁琐的环境配置，此处使用"),a("code",[s._v("docker")]),s._v("以及"),a("code",[s._v("docke-compose")]),s._v("来构建"),a("code",[s._v("Gitea")]),s._v("的环境")])]),s._v(" "),a("ol",[a("li",[a("p",[s._v("安装"),a("code",[s._v("docker")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("首先进入"),a("code",[s._v("docker")]),s._v("官方文档站(由于本博客所用服务器为"),a("code",[s._v("Centos")]),s._v("，所以选择"),a("code",[s._v("Centos")]),s._v("版本)，[docker]("),a("a",{attrs:{href:"https://docs.docker.com/engine/install/centos/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Install Docker Engine on CentOS | Docker Documentation"),a("OutboundLink")],1),s._v(")")])]),s._v(" "),a("li",[a("p",[s._v("若是第一次安装则依次执行命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装yum-utils包(它提供yum-config-manager实用程序)并设置稳定存储库。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --add-repo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    https://download.docker.com/linux/centos/docker-ce.repo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装Docker Engine和containerd的最新版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("若之前安装有老版本的"),a("code",[s._v("docker")]),s._v("，则需要先执行下述命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove docker "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client-latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-common "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest-logrotate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-logrotate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-engine\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("进行到此处就安装完成")])]),s._v(" "),a("li",[a("p",[s._v("设置开机自启")]),s._v(" "),a("p",[a("code",[s._v("systemctl enable docker.service")])])]),s._v(" "),a("li",[a("p",[s._v("启动"),a("code",[s._v("docker")])]),s._v(" "),a("p",[a("code",[s._v("systemctl start docker")])])])])]),s._v(" "),a("li",[a("p",[s._v("安装"),a("code",[s._v("docker-compose")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("进入[安装页面]("),a("a",{attrs:{href:"https://docs.docker.com/compose/install/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Install Docker Compose | Docker Documentation"),a("OutboundLink")],1),s._v("),选择你的操作系统版本，此处我选择"),a("code",[s._v("linux")])])]),s._v(" "),a("li",[a("p",[s._v("依次执行下列命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载最新版本的稳定版本docker-compose")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/docker/compose/releases/download/1.29.2/docker-compose-'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -s"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -m"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" -o /usr/local/bin/docker-compose\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为docker-compose添加权限")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/bin/docker-compose\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加链接")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/local/bin/docker-compose /usr/bin/docker-compose\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 验证安装")]),s._v("\n docker-compose --version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("至此"),a("code",[s._v("docker-compose")]),s._v("安装完成")])]),s._v(" "),a("li",[a("p",[s._v("后台启动"),a("code",[s._v("docker-compose")])]),s._v(" "),a("p",[a("code",[s._v("docker-compose up -d server")])]),s._v(" "),a("p",[s._v("验证是否启动")]),s._v(" "),a("p",[a("code",[s._v("docker-compose ps")])])])])]),s._v(" "),a("li",[a("p",[s._v("安装"),a("code",[s._v("Gitea")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("[官网]("),a("a",{attrs:{href:"https://docs.gitea.io/en-us/install-with-docker/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Installation with Docker - Docs (gitea.io)"),a("OutboundLink")],1),s._v(")")])]),s._v(" "),a("li",[a("p",[s._v("在"),a("code",[s._v("/home")]),s._v("目录下创建目录"),a("code",[s._v("gitea")])])]),s._v(" "),a("li",[a("p",[s._v("新建配置文件"),a("code",[s._v("docker-compose.yml")])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("gitea")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("external")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gitea/gitea"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gitea\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" USER_UID=1000\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" USER_GID=1000\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" DB_TYPE=mysql\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" DB_HOST=db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" DB_NAME=gitea\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" DB_USER=gitea\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" DB_PASSWD=gitea\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" gitea\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ./data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/data\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /etc/timezone"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/etc/timezone"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("ro\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /etc/localtime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/etc/localtime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("ro\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3000:3000"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"222:222"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" db\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("db")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" MYSQL_ROOT_PASSWORD=gitea\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" MYSQL_USER=gitea\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" MYSQL_PASSWORD=gitea\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" MYSQL_DATABASE=gitea\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" gitea\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ./mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/lib/mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("在当前目录下启动"),a("code",[s._v("docker-compose")])]),s._v(" "),a("p",[a("code",[s._v("docker-compose up server")])]),s._v(" "),a("p",[s._v("会按照你的配置文件下载环境依赖")])]),s._v(" "),a("li",[a("p",[s._v("开启防火墙端口3000，由于外网访问Gitea需要通过3000端口，所以开启此处防火墙端口3000需要打开，并且服务器中也要添加对应规则")]),s._v(" "),a("p",[a("code",[s._v("firewall-cmd --permanent --zone=public --add-port=3000/tcp")])])]),s._v(" "),a("li",[a("p",[s._v("外网访问"),a("code",[s._v("http://{主机ip}:3000")])]),s._v(" "),a("p",[s._v("网站会要求你配置一些信息，配置SSH服务域名为你的主机"),a("code",[s._v("ip")]),s._v("，"),a("code",[s._v("Gitea")]),s._v("基本"),a("code",[s._v("URL")]),s._v("为"),a("code",[s._v("http://{主机ip}:3000")])])]),s._v(" "),a("li",[a("p",[s._v("至此就完成安装，之后可以注册账号，登录就可以开始建立仓库正常使用了")])])])])]),s._v(" "),a("blockquote",[a("p",[s._v("若使用http传输每次提交都需要输入账号密码，所以接下来配置使用SSH传输")])]),s._v(" "),a("h2",{attrs:{id:"第二步-配置ssh密钥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-配置ssh密钥"}},[s._v("#")]),s._v(" 第二步： 配置SSH密钥")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("查看自己电脑的SSH密钥，路径一般为"),a("code",[s._v("‪C:\\Users\\用户\\.ssh\\id_rsa.pub")])])]),s._v(" "),a("li",[a("p",[s._v("复制密钥到 "),a("code",[s._v("Gitea")]),s._v("中")]),s._v(" "),a("p",[a("code",[s._v("点击头像=>设置=>SSH/GPG密钥=>增加密钥")])]),s._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[s._v("配置成功后即可使用SSH进行仓库的一系列操作了")])])])]),s._v(" "),a("h2",{attrs:{id:"第三步-将博客代码发布到个人仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-将博客代码发布到个人仓库"}},[s._v("#")]),s._v(" 第三步： 将博客代码发布到个人仓库")]),s._v(" "),a("ol",[a("li",[s._v("首先创建一个仓库用于存储博客的相关代码")])]),s._v(" "),a("ul",[a("li",[s._v("点击创建新仓库")]),s._v(" "),a("li",[s._v("起名")]),s._v(" "),a("li",[s._v("创建完毕，很简单吧")])]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[s._v("配置博客部署脚本文件")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/usr/bin/env sh")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确保脚本抛出遇到的错误")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" -e\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成静态文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run docs:build\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入生成的文件夹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" docs/.vuepress/dist\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -A\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit -m "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'deploy'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 格式为 git push -f ssh://git@{主机ip}:端口/{仓库地址} 分支名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh后面的部分可以建立好仓库后直接复制过来即可")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push -f ssh://git@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(":222/root/Vuepress-Vdoing-Blog.git master\n \n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" -\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("部署")])]),s._v(" "),a("p",[a("code",[s._v("yarn run deploy\t或者\t npm run deploy")])]),s._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[a("p",[s._v("登录"),a("code",[s._v("Gitea")]),s._v("查看是否代码上传成功")])]),s._v(" "),a("li",[a("p",[s._v("进入服务器进行，此处使用"),a("code",[s._v("Xshell")])])])]),s._v(" "),a("h2",{attrs:{id:"第四步-配置nginx以及同步博客"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第四步-配置nginx以及同步博客"}},[s._v("#")]),s._v(" 第四步： 配置"),a("code",[s._v("nginx")]),s._v("以及同步博客")]),s._v(" "),a("blockquote",[a("p",[s._v("终于到了最关键的一步了，这也是最繁琐的一步，让我碰了不少璧，以下是配置过程")])]),s._v(" "),a("ol",[a("li",[a("p",[s._v("下载安装"),a("code",[s._v("nginx")])]),s._v(" "),a("p",[s._v("这个直接百度即可，没有什么特别需要注意的地方，此处放上一个个人感觉比较详细的教程以供参考[教程]("),a("a",{attrs:{href:"https://www.jianshu.com/p/9f2c162ac77c",target:"_blank",rel:"noopener noreferrer"}},[s._v("Linux下安装Nginx - 简书 (jianshu.com)"),a("OutboundLink")],1),s._v(")")])]),s._v(" "),a("li",[a("p",[s._v("配置"),a("code",[s._v("nginx.conf")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        listen       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 监听端口")]),s._v("\n        server_name  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("106.14")]),s._v(".196.77"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果有域名此处可填域名，没有直接填主机ip即可，有域名之后让域名解析到此ip也可以")]),s._v("\n\n        charset utf-8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 路由路径为 / ")]),s._v("\n            root   /home/project/blog"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网站目录")]),s._v("\n            index  index.html index.htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$uri")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$uri")]),s._v("/ /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        error_page   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("503")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v("  /50x.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /50x.html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            root   html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("将仓库内的文件同步到"),a("code",[s._v("nignx")]),s._v("配置文件中的root目录")])])]),s._v(" "),a("blockquote",[a("p",[s._v("此处有点小坑，不知道怎么了，此处配置了git的hook也无法自动帮我同步，于是我直接配置了两个定时任务，会在每天0点和12点帮我同步，一天更新两次应该够了吧🚓")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("进入你所安装"),a("code",[s._v("Gitea")]),s._v("的目录，进入"),a("code",[s._v("data/git/repositories")]),s._v("目录，然后进入到你所创建的存储代码仓库的目录中，再进入"),a("code",[s._v("hooks")]),s._v(",执行以下命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" post-update.sample post-update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" post-update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" post-update\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("然后将"),a("code",[s._v("post-update")]),s._v("文件中的代码替换为以下代码")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# An example hook script to prepare a packed repository for use over")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dumb transports.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# To enable this hook, rename this file to "post-update".')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exec git update-server-info")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GIT_REPO")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/gitea/data/git/repositories/root/vuepress-vdoing-blog.git\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PUBLIC_WWW")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/project/blog\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TMP_GIT_CLONE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/tmp/blog\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TMP_GIT_CLONE}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GIT_REPO")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$TMP_GIT_CLONE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PUBLIC_WWW}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -rf "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TMP_GIT_CLONE}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PUBLIC_WWW}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("blockquote",[a("p",[s._v("上述代码的意思就是，先将仓库中的代码保存到一个临时存储区"),a("code",[s._v("TMP_GIT_CLONE")]),s._v(",再将这个临时存储区中的代码复制进网站仓库"),a("code",[s._v("PUBLIC_WWW")]),s._v("（即"),a("code",[s._v("nginx.conf")]),s._v("文件中配置的root属性）,此处修改的是post-update，按理来说当我提交了push操作后会执行这个脚本，但是并没有，所以我设置了两个定时任务，如果你部署时也遇到这个情况可以考虑我这个定时任务")])]),s._v(" "),a("blockquote",[a("p",[s._v("输入crontab -e后，黏贴以下代码")])]),s._v(" "),a("p",[a("code",[s._v("0 12 * * * sh /home/gitea/data/git/repositories/root/vuepress-vdoing-blog.git/hooks/post-update")]),s._v(" "),a("code",[s._v("0 0 * * * sh /home/gitea/data/git/repositories/root/vuepress-vdoing-blog.git/hooks/post-update")])]),s._v(" "),a("blockquote",[a("p",[s._v("Tip: 注意： 你的文件目录可能跟我的不一样")])])])]),s._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[s._v("执行完这个操作后，你的网站目录下就会出现你的博客目录，在外网中访问你的网站即可")])]),s._v(" "),a("h2",{attrs:{id:"第五步-完结撒花-总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第五步-完结撒花-总结"}},[s._v("#")]),s._v(" 第五步： 完结撒花，总结")]),s._v(" "),a("blockquote",[a("p",[s._v("由于种种原因，本次博客的部署可谓是十分艰难，但好在最终还是成功的部署到了自己的服务器上，也学习到了很多东西，比如第一次使用"),a("code",[s._v("docker")]),s._v("等")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("鸡汤")]),s._v(" "),a("p",[s._v("​\t“没有激流就称不上勇进，没有山峰则谈不上攀登”")])])])}),[],!1,null,null,null);t.default=e.exports}}]);