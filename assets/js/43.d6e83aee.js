(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{486:function(s,t,a){"use strict";a.r(t);var n=a(9),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"组件的自定义事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组件的自定义事件"}},[s._v("#")]),s._v(" 组件的自定义事件")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("一种组件间通信的方式，适用于："),a("code",[s._v("子组件===>父组件")])])]),s._v(" "),a("li",[a("p",[s._v("使用场景：子组件想给父组件传递数据时")])]),s._v(" "),a("li",[a("p",[s._v("绑定自定义事件")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("第一种方式："),a("code",[s._v("<Demo @nilu='getStuName'/>")])])]),s._v(" "),a("li",[a("p",[s._v("第二种方式：")]),s._v(" "),a("div",{staticClass:"language-vue line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("Student")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v("student"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("/>")])]),s._v("   \n  ...\n  mounted(){\n    this.$refs.student.$on('nilu',this.getStuName)\n  }\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("如果只想让自定义事件触发一次，可以使用once修饰符或$once方法")])])])]),s._v(" "),a("li",[a("p",[s._v("触发自定义事件："),a("code",[s._v("this.$emit('Demo',数据)")])])]),s._v(" "),a("li",[a("p",[s._v("解绑自定义事件：`this.$off('Demo')")])]),s._v(" "),a("li",[a("p",[s._v("组件上若要绑定原生DOM事件，需要使用native修饰符")]),s._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("Student")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v("student"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("@click.native")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")]),s._v("show"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("/>")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("注意：通过"),a("code",[s._v("this.$refs.student.$on('nilu',回调)")]),s._v("绑定自定义事件时，回调要么定义在methods中，要么使用箭头函数，否则this指向将出问题 "),a("em",[a("strong",[s._v("(Vue规定谁触发事件，回调函数中的this就是谁，所以此处需要写箭头函数，this才会指向当前App，如果写成普通函数，则this指向student对象)")])])])])]),s._v(" "),a("h2",{attrs:{id:"全局事件总线"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局事件总线"}},[s._v("#")]),s._v(" 全局事件总线")]),s._v(" "),a("ol",[a("li",[s._v("一种组件间通信的方式，适用于任意组件间通信")]),s._v(" "),a("li",[s._v("安装全局事件总线")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("new Vue({\n  ...\n  // 安装全局事件总线\n  beforeCreate(){\n    Vue.prototype.$bus=this\n  }\n})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[s._v("使用事件总线")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("接收数据：A组件想接收数据，则A组件中给$bus绑定自定义事件，事件的"),a("strong",[s._v("回调留在A组件自身")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mounted(){\n  this.$bus.$on('xxx',回调函数)\n},\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("提供数据："),a("code",[s._v("this.$bus.$emit('xxx',数据)")])])])])]),s._v(" "),a("li",[a("p",[s._v("最好在beforeDestroy钩子中，使用$off解绑"),a("strong",[s._v("当前组件")]),s._v("用到的事件")])])]),s._v(" "),a("h2",{attrs:{id:"消息订阅与发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#消息订阅与发布"}},[s._v("#")]),s._v(" 消息订阅与发布")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("一种组件间通信的方式，适用于任意组件间通信")])]),s._v(" "),a("li",[a("p",[s._v("使用步骤")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("安装pubsub : "),a("code",[s._v("npm i pubsub-js")])])]),s._v(" "),a("li",[a("p",[s._v("引入： "),a("code",[s._v("import pubsub from 'pubsub-js'")])])]),s._v(" "),a("li",[a("p",[s._v("接收数据：A组件想接收数据，则在A组件中订阅消息，订阅的回调留在A自身")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("  // 消息订阅\n  mounted(){\n    // 如果回调函数写正常函数，则函数内的this为undefined\n      this.pubid = pubsub.subscribe('test',(_,data)=>{\n        console.log(\"School....\",data)\n      })\n  },\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("strong",[s._v("或者")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("  methods:{\n    demo(){...}\n  },\n  mounted(){\n    this.pubid = pubsub.subscribe('test',this.demo)\n  }\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("提供数据 "),a("code",[s._v("pubsub.publish('test',数据)")])])]),s._v(" "),a("li",[a("p",[s._v("最好在beforeDestroy钩子中，使用"),a("code",[s._v("pubsub.unsubscribe(this.pubid)")]),s._v("取消订阅")])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);